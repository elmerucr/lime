Sections:
00: "seg10000" (10000-10158)


Source: "rom.s"
                            	     1: ; ----------------------------------------------------------------------
                            	     2: ; rom.s (assembles with vasmm68k_mot)
                            	     3: ; lime
                            	     4: ;
                            	     5: ; Copyright © 2025 elmerucr. All rights reserved.
                            	     6: ; ----------------------------------------------------------------------
                            	     7: 
                            	     8: 	include	"definitions.i"

Source: "definitions.i"
                            	     1: ; ----------------------------------------------------------------------
                            	     2: ; definitions.i
                            	     3: ; lime
                            	     4: ;
                            	     5: ; Copyright © 2025 elmerucr. All rights reserved.
                            	     6: ; ----------------------------------------------------------------------
                            	     7: 
                            	     8: ; vectors
                            	     9: VEC_ADDR_ERROR			equ	$000c
                            	    10: VEC_LVL1_IRQ_AUTO		equ	$0064
                            	    11: VEC_LVL4_IRQ_AUTO		equ	$0070	; entry point for timer
                            	    12: VEC_LVL6_IRQ_AUTO		equ	$0078	; entry point for vdc
                            	    13: VEC_TIMER0			equ	$0100
                            	    14: VEC_TIMER1			equ	$0104
                            	    15: VEC_TIMER2			equ	$0108
                            	    16: VEC_TIMER3			equ	$010c
                            	    17: VEC_TIMER4			equ	$0110
                            	    18: VEC_TIMER5			equ	$0114
                            	    19: VEC_TIMER6			equ	$0118
                            	    20: VEC_TIMER7			equ	$011c
                            	    21: 
                            	    22: ; vdc (video display controller)
                            	    23: VDC_SR				equ	$0400
                            	    24: VDC_CR				equ	$0401
                            	    25: VDC_BG_COLOR			equ	$0404
                            	    26: VDC_CURRENT_SPRITE		equ	$0407
                            	    27: VDC_CURRENT_SCANLINE_MSB	equ	$040c
                            	    28: VDC_CURRENT_SCANLINE_LSB	equ	$040d
                            	    29: VDC_IRQ_SCANLINE_MSB		equ	$040e
                            	    30: VDC_IRQ_SCANLINE_LSB		equ	$040f
                            	    31: 
                            	    32: VDC_SPRITE_X			equ	$0420
                            	    33: 
                            	    34: VDC_TILESET0			equ	$0800
                            	    35: VDC_TILESET1			equ	$1000
                            	    36: 
                            	    37: ; timer
                            	    38: TIMER_SR			equ	$0440
                            	    39: TIMER_CR			equ	$0441
                            	    40: TIMER0_BPM			equ	$0450
                            	    41: TIMER1_BPM			equ	$0452
                            	    42: TIMER2_BPM			equ	$0454
                            	    43: TIMER3_BPM			equ	$0456
                            	    44: TIMER4_BPM			equ	$0458
                            	    45: TIMER5_BPM			equ	$045a
                            	    46: TIMER6_BPM			equ	$045c
                            	    47: TIMER7_BPM			equ	$045e
                            	    48: 
                            	    49: ; core
                            	    50: CORE_ROMS			equ	$0482
                            	    51: CORE_INPUT0			equ	$0488
                            	    52: 

Source: "rom.s"
                            	     9: 
                            	    10: LOGO_ANIMATION	equ	$3000
                            	    11: 
                            	    12: 
                            	    13: 	org	$00010000	; rom based at $10000
                            	    14: 
00:00010000 01000000        	    15: 	dc.l	$01000000	; initial ssp at end of ram
00:00010004 00010020        	    16: 	dc.l	_start		; reset vector
                            	    17: 
00:00010008 726F6D206D633638	    18: 	dc.b	"rom mc68000 0.2 20250914"
00:00010010 30303020302E3220
00:00010018 3230323530393134
                            	    19: 
                            	    20: 	align	2
                            	    21: 
                            	    22: _start
                            	    23: 	; fill vector table
00:00010020 21FC000100C8000C	    24: 	move.l	#exc_addr_error,VEC_ADDR_ERROR.w
00:00010028 21FC000100CC0064	    25: 	move.l	#exc_lvl1_irq_auto,VEC_LVL1_IRQ_AUTO.w
00:00010030 21FC000100CE0070	    26: 	move.l	#exc_lvl4_irq_auto,VEC_LVL4_IRQ_AUTO.w
00:00010038 21FC000100D80078	    27: 	move.l	#exc_lvl6_irq_auto,VEC_LVL6_IRQ_AUTO.w
                            	    28: 
                            	    29: 	; set usp
00:00010040 207C00010000    	    30: 	move.l	#$00010000,A0
00:00010046 4E60            	    31: 	move.l	A0,USP
                            	    32: 
00:00010048 003800020482    	    33: 	or.b	#%00000010,CORE_ROMS.w			; make rom font visible to cpu
00:0001004E 307C1000        	    34: 	movea	#VDC_TILESET1,A0
00:00010052 20D0            	    35: .1	move.l	(A0),(A0)+				; copy rom font to underlying ram
00:00010054 B0FC2000        	    36: 	cmpa	#VDC_TILESET1+$1000,A0
00:00010058 6600FFF8        	    37: 	bne	.1
00:0001005C 023800FD0482    	    38: 	and.b	#%11111101,CORE_ROMS.w			; turn off rom font
                            	    39: 
                            	    40: ; copy logo tiles
00:00010062 207C00010118    	    41: 	movea.l	#logo_tiles,A0
00:00010068 327C11C0        	    42: 	movea.w	#$11c0,A1
00:0001006C 12D8            	    43: .2	move.b	(A0)+,(A1)+
00:0001006E B1FC00010158    	    44: 	cmpa.l	#logo_tiles+64,A0
00:00010074 6600FFF6        	    45: 	bne	.2
                            	    46: 
                            	    47: ; init logo
00:00010078 207C000100F0    	    48: 	movea.l	#logo_data,A0
00:0001007E 4200            	    49: 	clr.b	D0
00:00010080 13C000000407    	    50: .3	move.b	D0,VDC_CURRENT_SPRITE
00:00010086 227C00000420    	    51: 	movea.l	#VDC_SPRITE_X,A1
00:0001008C 12D8            	    52: .4	move.b	(A0)+,(A1)+
00:0001008E B3FC00000425    	    53: 	cmpa.l	#VDC_SPRITE_X+5,A1
00:00010094 6600FFF6        	    54: 	bne	.4
00:00010098 5240            	    55: 	addq	#1,D0
00:0001009A B1FC00010118    	    56: 	cmpa.l	#logo_data+40,A0
00:000100A0 6600FFDE        	    57: 	bne	.3
                            	    58: 
                            	    59: ; set variable for letter wobble
00:000100A4 11FC00403000    	    60: 	move.b	#$40,LOGO_ANIMATION.w
                            	    61: 
                            	    62: ; set raster irq on scanline 159
00:000100AA 13FC009F0000040F	    63: 	move.b	#$9f,VDC_IRQ_SCANLINE_LSB
00:000100B2 13FC000100000401	    64: 	move.b	#%00000001,VDC_CR			; enable irq's for vdc
                            	    65: 
                            	    66: 
00:000100BA 46FC0200        	    67: 	move.w	#$0200,SR				; set status register (User Mode, ipl = 0)
00:000100BE 2F3C000100C8    	    68: 	move.l	#exc_addr_error,-(SP)			; test usp
                            	    69: 
00:000100C4 6000FFFE        	    70: .5	bra	.5					; loop forever, wait for events
                            	    71: 
                            	    72: exc_addr_error
00:000100C8 6000FFFE        	    73: 	bra	exc_addr_error				; TODO: bsod when this happens?
                            	    74: 
                            	    75: exc_lvl1_irq_auto
00:000100CC 4E73            	    76: 	rte
                            	    77: 
                            	    78: exc_lvl4_irq_auto					; coupled to timer
00:000100CE 2F00            	    79: 	move.l	D0,-(SP)
00:000100D0 10380440        	    80: 	move.b	TIMER_SR.w,D0
                            	    81: 	; rest of logic...
                            	    82: 	; which timer and jump to handler
00:000100D4 201F            	    83: 	move.l	(SP)+,D0
00:000100D6 4E73            	    84: 	rte
                            	    85: 
                            	    86: exc_lvl6_irq_auto					; coupled to vdc
00:000100D8 2F00            	    87: 	move.l	D0,-(SP)
                            	    88: 
00:000100DA 10380400        	    89: 	move.b	VDC_SR.w,D0
00:000100DE 6700000E        	    90: 	beq	.1
00:000100E2 11C00400        	    91: 	move.b	D0,VDC_SR.w
                            	    92: 
00:000100E6 11F804880404    	    93: 	move.b	CORE_INPUT0.w,VDC_BG_COLOR.w
                            	    94: 
00:000100EC 201F            	    95: 	move.l	(SP)+,D0
00:000100EE 4E73            	    96: .1	rte
                            	    97: 
                            	    98: logo_data
00:000100F0 70              	    99: 	dc.b	112,64,%111,0,$1c	; icon top left
00:000100F1 40
00:000100F2 07
00:000100F3 00
00:000100F4 1C
00:000100F5 78              	   100: 	dc.b	120,64,%111,0,$1d	; icon top right
00:000100F6 40
00:000100F7 07
00:000100F8 00
00:000100F9 1D
00:000100FA 70              	   101: 	dc.b	112,72,%111,0,$1e	; icon bottom left
00:000100FB 48
00:000100FC 07
00:000100FD 00
00:000100FE 1E
00:000100FF 78              	   102: 	dc.b	120,72,%111,0,$1f	; icon bottom right
00:00010100 48
00:00010101 07
00:00010102 00
00:00010103 1F
00:00010104 6B              	   103: 	dc.b	107,80,%111,0,$6c	; l
00:00010105 50
00:00010106 07
00:00010107 00
00:00010108 6C
00:00010109 70              	   104: 	dc.b	112,80,%111,0,$69	; i
00:0001010A 50
00:0001010B 07
00:0001010C 00
00:0001010D 69
00:0001010E 76              	   105: 	dc.b	118,80,%111,0,$6d	; m
00:0001010F 50
00:00010110 07
00:00010111 00
00:00010112 6D
00:00010113 7E              	   106: 	dc.b	126,80,%111,0,$65	; e
00:00010114 50
00:00010115 07
00:00010116 00
00:00010117 65
                            	   107: 
                            	   108: logo_tiles
00:00010118 00              	   109: 	dc.b	%00000000,%00000000	; tile 1 (icon upper left)
00:00010119 00
00:0001011A 01              	   110: 	dc.b	%00000001,%00000000
00:0001011B 00
00:0001011C 07              	   111: 	dc.b	%00000111,%10000000
00:0001011D 80
00:0001011E 07              	   112: 	dc.b	%00000111,%10100000
00:0001011F A0
00:00010120 1E              	   113: 	dc.b	%00011110,%11111000
00:00010121 F8
00:00010122 1E              	   114: 	dc.b	%00011110,%10101111
00:00010123 AF
00:00010124 1E              	   115: 	dc.b	%00011110,%10101010
00:00010125 AA
00:00010126 1E              	   116: 	dc.b	%00011110,%10101111
00:00010127 AF
                            	   117: 
00:00010128 00              	   118: 	dc.b	%00000000,%00000000	; tile 2 (icon upper right)
00:00010129 00
00:0001012A 00              	   119: 	dc.b	%00000000,%00000000
00:0001012B 00
00:0001012C 00              	   120: 	dc.b	%00000000,%00000000
00:0001012D 00
00:0001012E 00              	   121: 	dc.b	%00000000,%00000000
00:0001012F 00
00:00010130 00              	   122: 	dc.b	%00000000,%00000000
00:00010131 00
00:00010132 00              	   123: 	dc.b	%00000000,%00000000
00:00010133 00
00:00010134 C0              	   124: 	dc.b	%11000000,%00000000
00:00010135 00
00:00010136 B0              	   125: 	dc.b	%10110000,%00000000
00:00010137 00
                            	   126: 
00:00010138 1E              	   127: 	dc.b	%00011110,%11111010	; tile 3 (icon bottom left)
00:00010139 FA
00:0001013A 07              	   128: 	dc.b	%00000111,%10101010
00:0001013B AA
00:0001013C 07              	   129: 	dc.b	%00000111,%10101011
00:0001013D AB
00:0001013E 01              	   130: 	dc.b	%00000001,%11101011
00:0001013F EB
00:00010140 00              	   131: 	dc.b	%00000000,%01111110
00:00010141 7E
00:00010142 00              	   132: 	dc.b	%00000000,%00010111
00:00010143 17
00:00010144 00              	   133: 	dc.b	%00000000,%00000001
00:00010145 01
00:00010146 00              	   134: 	dc.b	%00000000,%00000000
00:00010147 00
                            	   135: 
00:00010148 EC              	   136: 	dc.b	%11101100,%00000000	; tile 4 (icon bottom right)
00:00010149 00
00:0001014A EE              	   137: 	dc.b	%11101110,%00000000
00:0001014B 00
00:0001014C AB              	   138: 	dc.b	%10101011,%10000000
00:0001014D 80
00:0001014E AB              	   139: 	dc.b	%10101011,%10100000
00:0001014F A0
00:00010150 AA              	   140: 	dc.b	%10101010,%11110100
00:00010151 F4
00:00010152 FF              	   141: 	dc.b	%11111111,%01010000
00:00010153 50
00:00010154 55              	   142: 	dc.b	%01010101,%00000000
00:00010155 00
00:00010156 00              	   143: 	dc.b	%00000000,%00000000
00:00010157 00
                            	   144: 


Symbols by name:
CORE_INPUT0                      E:00000488
CORE_ROMS                        E:00000482
LOGO_ANIMATION                   E:00003000
TIMER_SR                         E:00000440
VDC_BG_COLOR                     E:00000404
VDC_CR                           E:00000401
VDC_CURRENT_SPRITE               E:00000407
VDC_IRQ_SCANLINE_LSB             E:0000040F
VDC_SPRITE_X                     E:00000420
VDC_SR                           E:00000400
VDC_TILESET1                     E:00001000
VEC_ADDR_ERROR                   E:0000000C
VEC_LVL1_IRQ_AUTO                E:00000064
VEC_LVL4_IRQ_AUTO                E:00000070
VEC_LVL6_IRQ_AUTO                E:00000078
_start                           A:00010020
exc_addr_error                   A:000100C8
exc_lvl1_irq_auto                A:000100CC
exc_lvl4_irq_auto                A:000100CE
exc_lvl6_irq_auto                A:000100D8
logo_data                        A:000100F0
logo_tiles                       A:00010118

Symbols by value:
0000000C VEC_ADDR_ERROR
00000064 VEC_LVL1_IRQ_AUTO
00000070 VEC_LVL4_IRQ_AUTO
00000078 VEC_LVL6_IRQ_AUTO
00000400 VDC_SR
00000401 VDC_CR
00000404 VDC_BG_COLOR
00000407 VDC_CURRENT_SPRITE
0000040F VDC_IRQ_SCANLINE_LSB
00000420 VDC_SPRITE_X
00000440 TIMER_SR
00000482 CORE_ROMS
00000488 CORE_INPUT0
00001000 VDC_TILESET1
00003000 LOGO_ANIMATION
00010020 _start
000100C8 exc_addr_error
000100CC exc_lvl1_irq_auto
000100CE exc_lvl4_irq_auto
000100D8 exc_lvl6_irq_auto
000100F0 logo_data
00010118 logo_tiles
